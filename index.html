<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit tracker</title>
</head>
<body>
    <h1>Static Site Habit Tracker</h1>
    <button id='addHabitButton'>Add</button>
    <button id='createNewFile'>Create</button>
    <script>
        const addHabitButton = document.getElementById("addHabitButton");
        const createNewFile = document.getElementById("createNewFile");
        addHabitButton.addEventListener("click",getDataFunction);
        createNewFile.addEventListener("click",createNewFileFunction);
        
        function addHabit() {
            alert("Habit added");
        }

        async function getDataFunction() {
            const api_url = "https://api.github.com/repos/Pich78/tracker/contents/README.md?ref=gh-pages";
            try {
                const response = await fetch(api_url);
                console.log(await response.json());
            } catch (error) {
                console.log('Request Failed', error);
            }
        }
        
        async function createNewFileFunction() {
            const user =  { name:  'Antonio', surname:  'Picciano'  };
            const token = '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';
            const api_url = "https://api.github.com/repos/Pich78/tracker/contents/test.txt?ref=gh-pages";
            try {
                const response = await fetch(api_url,   {
                                                            method: 'POST',
                                                            headers: {
                                                                'Authorization': `token ${token}`,
                                                                'Content-Type': 'application/json;charset=utf-8'
                                                            }, 
                                                            body: JSON.stringify(user)
                                                        }
                                            );
                console.log(await response.json());
            } catch (error) {
                console.log('Request Failed', error);
            }
        }
        
        
    </script>
</body>
</html>
